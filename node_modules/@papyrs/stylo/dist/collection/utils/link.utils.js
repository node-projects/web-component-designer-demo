import { isFirefox } from '/web-component-designer-demo/node_modules/@deckdeckgo/utils/lib/esm/index.js';
import { toHTMLElement } from './node.utils.js';
import { getRange } from './selection.utils.js';
export const createLink = ({ range, linkUrl }) => {
  const fragment = range.extractContents();
  const a = createLinkElement({ fragment, linkUrl });
  range.insertNode(a);
};
export const removeLink = (container) => {
  const { range, selection } = getRange(container);
  if (!range) {
    return;
  }
  if (isFirefox()) {
    removeFirefoxLink(selection);
    return;
  }
  const anchor = toHTMLElement(selection.anchorNode);
  const fragment = range.extractContents();
  anchor.parentElement.replaceChild(fragment, anchor);
};
const removeFirefoxLink = (selection) => {
  const container = toHTMLElement(selection.anchorNode);
  if (!container || container.nodeName.toLowerCase() !== 'a') {
    return;
  }
  container.parentElement.insertBefore(document.createTextNode(container.textContent), container);
  container.parentElement.removeChild(container);
};
const createLinkElement = ({ fragment, linkUrl }) => {
  const a = document.createElement('a');
  a.appendChild(fragment);
  a.href = linkUrl;
  a.rel = 'noopener noreferrer';
  return a;
};
