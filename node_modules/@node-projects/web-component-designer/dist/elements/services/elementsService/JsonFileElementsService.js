import { LazyLoader } from "../../../../../base-custom-webcomponent/dist/index.js"; // Reads a Json File and provides the Elements listed there

export class JsonFileElementsService {
  constructor(name, file) {
    this._name = name;
    LazyLoader.LoadText(file).then(data => {
      let parsed = JSON.parse(data);
      this._elementList = [];
      parsed.elements.forEach(element => {
        if (this.isIElementDefintion(element)) this._elementList.push(element);else this._elementList.push({
          tag: element
        });
      });
      if (this._resolveStored) this._resolveStored(this._elementList);
    }).catch(err => {
      if (this._rejectStored) this._rejectStored(err);
    });
  }

  get name() {
    return this._name;
  }

  getElements() {
    if (this._elementList) return Promise.resolve(this._elementList);
    return new Promise((resolve, reject) => {
      this._resolveStored = resolve;
      this._rejectStored = reject;
    });
  }

  isIElementDefintion(object) {
    return object != null && object.tag != null;
  }

}